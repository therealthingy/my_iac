---
- hosts: all
  become: true
  roles:
    - role: common
      tags:
        - common


# --  "HW specific"  --
- hosts: rpis
  become: true
  roles:
    - role: hw-specific/rpi
      tags:
        - rpi

- hosts: vmware_vms
  become: true
  roles:
    - role: hw-specific/vmware
      tags:
        - vmware


# --  "System specific"  --
- hosts: workstations, dev_workstations
  vars:
    firefox_profiles:
      default:
        extensions:
          # URL on addons.mozilla.org
          - ublock-origin
          - umatrix
          - darkreader
          - save-page-we
          - i-dont-care-about-cookies
        # Privacy friendly settings reference: https://github.com/pyllyukko/user.js/blob/master/user.js
        preferences:
          network.cookie.cookieBehavior: 1
          privacy.donottrackheader.enabled: true
          datareporting.healthreport.uploadEnabled: false
  become: true
  roles:
    - role: workstation/base
    - role: staticdev.firefox     # >>>>>>>>>>>>    TODO: include_role
  tags: workstation

- hosts: dev_workstations
  become: true
  roles:
    - role: workstation/dev_workstation
      tags:
        - workstation
        - dev_workstation
    - role: docker
      tags:
        - docker


- hosts: servers, dev_servers, home_servers
  become: true
  roles:
    - role: server/base
      tags:
        - server
        - home_server
    - role: docker
      tags:
        - docker

- hosts: dev_servers
  roles:
    - role: server/dev_server
  tags:
    - dev_server

- hosts: home_servers
  vars:
    docker_container_data_basedir: /home/{{ user_name }}/homeserver_data/container_data
    docker_container_config_basedir: /home/{{ user_name }}/homeserver_config/container_config
  roles:
    - role: server/home_server/base
    - role: server/home_server/containers/bitwarden
      tags:
        - bitwarden
    - role: server/home_server/containers/nginx-helloworld
      tags:
        - testing
    - role: server/home_server/containers/pihole
      tags:
        - pihole
    - role: server/home_server/containers/portainer
      tags:
        - portainer

# KEEP IN MIND: Only run samba - OR - filebrowser (otherwise weird behvaior when using simultaneously)
    - role: server/home_server/containers/filebrowser
      tags:
        - filebrowser
    - role: server/home_server/containers/samba
      tags:
        - samba

    - role: server/home_server/containers/traefik
      tags:
        - traefik
    - role: server/home_server/containers/transmission
      tags:
        - transmission
    - role: server/home_server/containers/volact
      tags:
        - volact
    - role: server/home_server/containers/watchtower
      tags:
        - watchtower
  tags:
    - home_server
